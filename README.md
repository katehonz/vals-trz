# vals-trz - Система за Заплати и Човешки ресурси

[![License: BSD-3-Clause](https://img.shields.io/badge/License-BSD_3--Clause-blue.svg)](LICENSE)

Уеб-базирана система за управление на персонала и изчисляване на работни заплати (ТРЗ). Проектът предоставя пълен набор от функции за HR отдели и счетоводители в български предприятия. Вижте [ARCHITECTURE.md](ARCHITECTURE.md) за обосновка на архитектурните решения.

> **Забележка:** Публикувано е **ядрото** на системата. Разработката на основните модули е завършена, но проектът не е преминал през пълно тестване в продукционна среда. Използвайте на свой риск - тествайте внимателно преди употреба. Приносите (pull requests) са добре дошли!

## Технологии

| Компонент | Технология |
|-----------|-----------|
| Backend | Java 21, Spring Boot 3.4 |
| Frontend | React, TypeScript, Vite |
| База данни | ArangoDB 3.12 |
| Build | Maven (backend), npm (frontend) |

## Модули

### 1. Данни и настройки
- **Фирмени данни** - БУЛСТАТ, адрес, персонални данни на ръководителя, НКИД, видове персонал
- **ДТВ за ТСПО** - Допълнително трудово възнаграждение за трудов стаж и професионален опит (проценти по клас)
- **Времеви данни** - Работен календар, брой работни дни/часове, часови схеми на работа (8ч, 7ч, 6ч и др.)
- **Годишен работен календар** - Официални празници, работни и почивни дни по месеци
- **Осигурителни вноски и прагове** - МРЗ, осигурителни прагове по НКПД, вноски за фондове (ДОО, ДЗПО, ЗО)
- **Пера за възнаграждение** - Пера като % от основна заплата, като лева по, като фиксирани суми, изчисляеми пера
- **Пера за удръжки** - Удръжки от заплата (данъци, осигуровки, аванси, запори)
- **Номенклатури** - Служебни и потребителски класификатори

### 2. Структура и персонал
- **Организационна структура** - Дървовидна йерархия на отдели и звена
- **Лични данни** - ЕГН, имена, адрес, образование, семейно положение, банкова сметка
- **Служебни данни** - Трудов договор, длъжност, НКПД, работно време, вид осигуряване, основно възнаграждение
- **Възнаграждения** - Почасови, като лв. по, еднократни, многократни
- **Удръжки** - Регулярни и еднократни удръжки от заплатата
- **Отсъствия** - Отпуски (платен, неплатен, учебен), болнични, майчинство, самоотлъчка
- **Часова месечна карта** - Присъствена ведомост по дни и часове
- **Документи** - Трудови договори, допълнителни споразумения, заповеди, длъжностни характеристики

### 3. Работа с документи
- **HR документи** - Автоматично генериране по шаблони с кодове (#nnnnn#)
- **Трудови документи** - Трудов договор, ДС, заповед за прекратяване
- **Оперативни документи** - Заповеди за отпуск, командировка и др.
- **Графици и СИРВ** - Сумирано изчисляване на работното време, графици по смени
- **Сделни заработки** - Индивидуални и групови работни карти, разценки по операции/изделия

### 4. Справки и отчети
- **Изчисляване на заплати** - Месечно начисляване на възнаграждения, автоматично зареждане
- **Ведомости** - Общи ведомости за заплати, рекапитулации, присъствени ведомости
- **Фишове** - Индивидуални фишове за заплата (печат и електронни)
- **Рекапитулация и статистика** - Обща рекапитулация, по категории персонал, консолидирана
- **Статистика** - Данни за НСИ, аналитични графики, анализ на персонала, икономически анализ

### 5. Данни за НАП и НОИ
- **Декларация 1** - Месечни данни за осигурените лица
- **Декларация 6** - Общи суми на осигурителните вноски
- **Уведомления по чл. 62** - Регистрация/прекратяване на трудови договори
- **Уведомления по чл. 123** - При промяна на работодател
- **Данни за НОИ** - Болнични листове, обработка на дни за временна нетрудоспособност

### 6. Удостоверения и списъци
- **Удостоверения** - Лични удостоверения, декларации, служебни бележки
- **УП-3, УП-2** - Удостоверения за трудов и осигурителен стаж/доход
- **Списъци** - Настроеми списъци на персонала

### 7. Банкови сметки и плащания
- **Банкови сметки** - Управление на IBAN сметки на персонала
- **Масови плащания** - Формиране на файлове за банков превод
- **Платежни документи** - Генериране на платежни за НАП

### 8. Администриране
- **Месечен цикъл** - Започване на нов месец, съхраняване на ведомост
- **Заключване** - Заключване/отключване на изчисленията
- **Синхронизация** - Между месеци и между години

### 9. Сервизни функции
- **Импорт/Експорт** - CSV импорт на данни за персонала
- **Настройки на UI** - Параметри на интерфейса
- **Системна поддръжка** - Контрол и диагностика

## Стартиране

### Предварителни изисквания
- Java 21
- Node.js 18+
- Docker (за ArangoDB)

### 1. Стартиране на ArangoDB
```bash
docker compose up -d
```
ArangoDB UI: http://localhost:8529 (root / rootpassword)

### 2. Стартиране на Backend
```bash
cd backend
mvn spring-boot:run
```
API: http://localhost:8080

### 3. Стартиране на Frontend
```bash
cd frontend
npm run dev
```
Приложение: http://localhost:5173

## Структура на проекта

```
vals-trz/
├── docker-compose.yml          # ArangoDB контейнер
├── backend/                    # Java Spring Boot REST API
│   ├── pom.xml
│   └── src/main/java/com/valstrz/
│       ├── config/             # CORS, ArangoDB конфигурация
│       ├── entity/             # Доменни модели (ArangoDB документи)
│       ├── repository/         # ArangoDB репозитории
│       └── controller/         # REST контролери
├── frontend/                   # React SPA
│   ├── package.json
│   ├── vite.config.ts          # Proxy към backend
│   └── src/
│       ├── api/                # API клиент
│       ├── types/              # TypeScript интерфейси
│       └── components/         # React компоненти
└── docs/                       # Документация
```

## Лиценз

Този проект е лицензиран под [BSD 3-Clause License](LICENSE).
